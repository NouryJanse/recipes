---
import Recipe from "../../components/Recipe";

interface Props {
  recipes: { id: string }[];
}

export async function getStaticPaths() {
  const RECIPES_API_URL = import.meta.env.RECIPES_API_URL;
  let recipes = [];
  if (RECIPES_API_URL) {
    const recipesJSON = await fetch(`${RECIPES_API_URL}/api/recipes`);
    if (recipesJSON.status === 200) {
      recipes = await recipesJSON.json();
    }
  }

  const paths = recipes.map((recipe: any) => {
    return {
      params: { id: recipe.id },
      props: { recipes },
    };
  });
  return paths;
}

const { id } = Astro.params;
const { recipes } = Astro.props;
const currentRecipe = recipes.find((recipe) => recipe.id == id);
---

<div>
  <Recipe recipe={currentRecipe} />
</div>
